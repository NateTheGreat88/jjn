<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secrets - JNJ Website</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="secret-pages.css">
    <link rel="stylesheet" href="animated-background.css">
    <script src="page-transitions.js" defer></script>
    <script src="secret-pages.js" defer></script>
    <script src="animated-background.js" defer></script>
</head>
<body>
    <div class="container">
        <div class="top-controls">
            <a href="index.html" class="about-button">‚Üê Back to Home</a>
        </div>
        
        <header>
            <h1><img id="lockEmoji" src="unlock.png" alt="üîê" style="cursor: pointer; user-select: none; transition: all 0.3s ease; display: inline-block; width: 48px; height: 48px; vertical-align: middle; filter: grayscale(1) brightness(0.8);"> Secrets</h1>
            <p class="subtitle">Hidden pages and easter eggs</p>
        </header>

        <main>
            <div id="secretsGrid"></div>
            <div id="noSecretsMessage" class="no-secrets-message" style="display: none;">
                <p>No secrets discovered yet! Explore the site to find hidden pages.</p>
                <p style="margin-top: 10px; opacity: 0.7; font-size: 14px;">Try clicking the header, searching for "secret", or entering the Konami code!</p>
            </div>
        </main>

        <footer class="footer">
            <p class="footer-text">Built with creativity and collaboration</p>
            <p class="footer-year">¬© 2025 JNJ</p>
        </footer>
    </div>

    <script>
        // Games unlock mechanism
        let lockClickCount = 0;
        let lockClickTimeout = null;
        const GAMES_UNLOCK_KEY = 'jnjGamesUnlocked';
        
        function checkGamesUnlocked() {
            return localStorage.getItem(GAMES_UNLOCK_KEY) === 'true';
        }
        
        function unlockGames() {
            localStorage.setItem(GAMES_UNLOCK_KEY, 'true');
            const lockEmoji = document.getElementById('lockEmoji');
            if (lockEmoji) {
                lockEmoji.src = 'unlock.png';
                lockEmoji.style.filter = 'drop-shadow(0 0 8px #ffd700) brightness(1.3) saturate(1.2)';
                lockEmoji.style.transform = 'scale(1.1)';
            }
        }
        
        function handleLockClick(e) {
            e.preventDefault();
            e.stopPropagation(); // Prevent event from bubbling to header
            const lockEmoji = document.getElementById('lockEmoji');
            if (!lockEmoji) return;
            
            lockClickCount++;
            
            if (lockClickTimeout) {
                clearTimeout(lockClickTimeout);
            }
            
            lockClickTimeout = setTimeout(() => {
                lockClickCount = 0;
            }, 2000);
            
            if (lockClickCount === 9) {
                unlockGames();
                lockClickCount = 0;
            }
        }
        
        // Wait for secretPages to be available and secrets to load
        async function waitForSecretsAndDisplay() {
            // Wait for secretPages to be available
            let attempts = 0;
            while (!window.secretPages && attempts < 50) {
                await new Promise(resolve => setTimeout(resolve, 100));
                attempts++;
            }
            
            if (!window.secretPages) {
                console.error('secretPages not available');
                return;
            }
            
            // Load secrets first
            await window.secretPages.load();
            
            // Now get and display secrets
            const secrets = window.secretPages.getAll();
            console.log('Displaying secrets:', secrets);
            const grid = document.getElementById('secretsGrid');
            const noSecrets = document.getElementById('noSecretsMessage');
            let hasUnlocked = false;
            
            if (!grid || !noSecrets) {
                console.error('Grid or noSecrets element not found');
                return;
            }
            
            // Clear grid first
            grid.innerHTML = '';
            
            const secretConfigs = {
                'konami': {
                    name: 'Konami Code',
                    icon: 'üéÆ',
                    description: 'Classic gaming cheat code',
                    page: 'secret-konami.html',
                    color: '#4caf50'
                },
                'header': {
                    name: 'Header Secret',
                    icon: 'üëÜ',
                    description: 'Click the header 7 times',
                    page: 'secret-header.html',
                    color: '#ff6b6b'
                },
                'search': {
                    name: 'Search Secret',
                    icon: 'üîç',
                    description: 'Type "secret" in search',
                    page: 'secret-search.html',
                    color: '#4a9eff'
                },
                'footer': {
                    name: 'Footer Secret',
                    icon: 'üë£',
                    description: 'Hidden link in footer',
                    page: 'secret-footer.html',
                    color: '#8b5cf6'
                },
                'subtitle': {
                    name: 'Subtitle Secret',
                    icon: 'üìù',
                    description: 'Double-click the subtitle',
                    page: 'secret-subtitle.html',
                    color: '#00d4ff'
                },
                'rightclick': {
                    name: 'Right-Click Secret',
                    icon: 'üñ±Ô∏è',
                    description: 'Right-click on the header',
                    page: 'secret-rightclick.html',
                    color: '#ff00ff'
                },
                'devtools': {
                    name: 'Dev Tools Secret',
                    icon: '‚öôÔ∏è',
                    description: 'Press Ctrl+Shift+J',
                    page: 'secret-devtools.html',
                    color: '#00ff88'
                },
                'favicon': {
                    name: 'Favicon Secret',
                    icon: '‚≠ê',
                    description: 'Click the favicon 5 times',
                    page: 'secret-favicon.html',
                    color: '#ffaa00'
                },
                'chatcode': {
                    name: 'Chat Code Secret',
                    icon: 'üí¨',
                    description: 'Type "JNJ2025" in chat',
                    page: 'secret-chatcode.html',
                    color: '#ff3366'
                },
                'tripleclick': {
                    name: 'Triple-Click Secret',
                    icon: 'üëÜüëÜüëÜ',
                    description: 'Triple-click "About Us"',
                    page: 'secret-tripleclick.html',
                    color: '#9d4edd'
                }
            };
            
            Object.keys(secrets).forEach(key => {
                const secret = secrets[key];
                const config = secretConfigs[key];
                if (!config) return;
                
                if (secret.unlocked) {
                    hasUnlocked = true;
                    const card = document.createElement('div');
                    card.className = 'song-card';
                    card.setAttribute('data-title', config.name.toLowerCase());
                    card.setAttribute('data-description', config.description);
                    card.innerHTML = `
                        <a href="${config.page}" class="song-link">
                            <div class="song-button">
                                <div class="song-image" style="background: linear-gradient(135deg, ${config.color} 0%, ${config.color}dd 100%); display: flex; align-items: center; justify-content: center; font-size: 48px; color: white;">${config.icon}</div>
                                <div class="song-info">
                                    <h2>${config.name}</h2>
                                    <p>${config.description}</p>
                                </div>
                            </div>
                            <span class="recent-indicator" title="Discovered">üîì</span>
                        </a>
                    `;
                    grid.appendChild(card);
                }
            });
                
            if (!hasUnlocked) {
                grid.style.display = 'none';
                noSecrets.style.display = 'block';
            } else {
                grid.style.display = 'grid';
                noSecrets.style.display = 'none';
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            // Setup lock emoji click handler
            const lockEmoji = document.getElementById('lockEmoji');
            if (lockEmoji) {
                lockEmoji.addEventListener('click', handleLockClick);
                
                // Check if already unlocked
                if (checkGamesUnlocked()) {
                    lockEmoji.src = 'unlock.png';
                    lockEmoji.style.filter = 'drop-shadow(0 0 8px #ffd700) brightness(1.3) saturate(1.2)';
                    lockEmoji.style.transform = 'scale(1.1)';
                }
            }
            
            // Wait for secrets and display them
            waitForSecretsAndDisplay();
            
            // Also listen for auth state changes to reload secrets
            window.addEventListener('authStateChanged', () => {
                waitForSecretsAndDisplay();
            });
            
            // Listen for storage changes to reload secrets (in case they're unlocked in another tab)
            window.addEventListener('storage', (e) => {
                if (e.key === 'jnjSecretPages') {
                    waitForSecretsAndDisplay();
                }
            });
        });
    </script>
</body>
</html>

